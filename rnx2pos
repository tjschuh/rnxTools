#!/bin/tcsh -f
#
# takes an unaltered RINEX file and
# outputs the approx position in XYZ 
# and Lat Lon Ht, and the RINEX file
# start and end times
#
# INPUT:
#
# $1     RIENX file
#
# OUTPUT:
#
# output to screen
#
# Originally written by tschuh-at-princeton.edu, 06/25/2021
# Last modified by tschuh-at-princeton.edu, 08/09/2021

# need to comment!

set file = $1

# Find the header bottom
set nrh = `rnx2hdr $file`

set line = `head -$nrh $file | awk '/TIME OF FIRST OBS/'`

set fyr = `printf "%4.4i" $line[1]`
set fmo = `printf "%2.2i" $line[2]`
set fdy = `printf "%2.2i" $line[3]`
set fhr = `printf "%2.2i" $line[4]`
set fmn = `printf "%2.2i" $line[5]`
set fsc = `printf "%010.7f" $line[6]`

set line = `head -$nrh $file | awk '/TIME OF LAST OBS/'`

set lyr = `printf "%4.4i" $line[1]`
set lmo = `printf "%2.2i" $line[2]`
set ldy = `printf "%2.2i" $line[3]`
set lhr = `printf "%2.2i" $line[4]`
set lmn = `printf "%2.2i" $line[5]`
set lsc = `printf "%010.7f" $line[6]`

set x = `head -$nrh $file | awk '/APPROX POSITION/ {print $1}'`
set y = `head -$nrh $file | awk '/APPROX POSITION/ {print $2}'`
set z = `head -$nrh $file | awk '/APPROX POSITION/ {print $3}'`

set llh = `xyz2llh.py -xyz $x $y $z`

echo $x $y $z "  " $llh "  " $fyr $fmo $fdy $fhr $fmn $fsc "  " $lyr $lmo $ldy $lhr $lmn $lsc
